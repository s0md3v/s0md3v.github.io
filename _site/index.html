<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Security Researcher &amp; Developer | Somdev Sangwan</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Security Researcher &amp; Developer" />
<meta name="author" content="Somdev Sangwan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Somdev Sangwan is a security researcher &amp; developer. He also writes about epistemology and ethics." />
<meta property="og:description" content="Somdev Sangwan is a security researcher &amp; developer. He also writes about epistemology and ethics." />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="Somdev Sangwan" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Security Researcher &amp; Developer" />
<meta name="twitter:site" content="@s0md3v" />
<meta name="twitter:creator" content="@s0md3v" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","author":{"@type":"Person","name":"Somdev Sangwan"},"description":"Somdev Sangwan is a security researcher &amp; developer. He also writes about epistemology and ethics.","headline":"Security Researcher &amp; Developer","name":"Somdev Sangwan","url":"http://localhost:4000/"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <style>
    :root {
        --base-font-size: 1rem;
        --blog-font-size: 1rem;
        --base-font-family: "Lexend", "Helvetica Neue", Helvetica, Arial, sans-serif;
        --blog-font-family: var(--base-font-family);

        --background-color: #fafafa;
        --foreground-color: #1a1a1a;
        --midground-color: #666666;
        --accent-color: #1976d2;
        --link-hover-bg: #e5e5e5;
        --muted-color: #666666;
        --border-color: #e5e5e5;
        --code-bg: #f0f0f0;
        --link-color: #0b5394;
        --link-visited: #0d47a1;
        --icon-filter: none;
    }

    .dark-mode {
        --background-color: #1e1e1e;
        --foreground-color: #e0e0e0;
        --midground-color: #a0a0a0;
        --accent-color: #42a5f5;
        --link-hover-bg: #333333;
        --muted-color: #888888;
        --border-color: #333333;
        --code-bg: #2d2d2d;
        --link-color: #64b5f6;
        --link-visited: #a6d6ff;
        --icon-filter: invert(1);
    }

    .cream-mode {
        --background-color: #f3f0e6;
        --foreground-color: #2d2a26;
        --midground-color: #5d564f;
        --accent-color: #1565c0;
        --link-hover-bg: #e6e2d6;
        --muted-color: #5d564f;
        --border-color: #dcd6c6;
        --code-bg: #e8e2d2;
        --link-color: #0d47a1;
        --link-visited: #0d47a1;
        --icon-filter: none;
    }

    * {
        font-feature-settings: "kern" 1, "liga" 1, "onum" 0;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-variant-numeric: normal;
    }

    html {
        -webkit-hyphens: auto;
        background: var(--background-color);
        color: var(--foreground-color);
        font-size: 1rem;
        height: 100%;
        hyphens: auto;
        margin: 0;
        padding: 0;
        scroll-behavior: smooth;
        overflow-y: scroll;
        text-rendering: optimizeLegibility;
    }

    body {
        display: flex;
        flex-direction: column;
        height: 100%;
        font: 400 16px/1.5 "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    a {
        background: none;
        color: var(--foreground-color);
        text-decoration: none;
    }

    a:hover {
        background: var(--link-hover-bg);
    }
</style>

<script>
    const themes = ["light", "dark", "cream"];

    function getPreferredTheme() {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme && themes.includes(savedTheme)) return savedTheme;

        const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        return systemPrefersDark ? "dark" : "light";
    }

    function applyTheme(theme) {
        document.documentElement.classList.remove("light-mode", "dark-mode", "cream-mode");
        document.documentElement.classList.add(`${theme}-mode`);
        localStorage.setItem("theme", theme);
    }

    try {
        const currentTheme = getPreferredTheme();
        applyTheme(currentTheme);
    } catch (e) {
        console.error("Theme initialization failed:", e);
    }

    try {
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (e) => {
            if (!localStorage.getItem("theme")) {
                applyTheme(e.matches ? "dark" : "light");
            }
        });
    } catch (e) { }
</script>

  
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet" media="print"
    onload="this.media='all'">
  <noscript>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
  </noscript>
  

  <link rel="stylesheet" href="/assets/css/fonts.css">
  <link rel="stylesheet" href="/assets/css/common.css">
  <script src="/assets/js/common.js" defer></script>


  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Somdev Sangwan",
  "url": "http://localhost:4000",
  "image": "http://localhost:4000/assets/images/profile.jpg",
  "jobTitle": "Security Researcher & Developer",
  "alternateName": "s0md3v",
  "description": "Somdev Sangwan is a security researcher & developer. He also writes about epistemology and ethics.",
  "knowsAbout": [
    "Computer Security",
    "Programming"
  ],
  "sameAs": [
    "https://twitter.com/s0md3v",
    "https://github.com/s0md3v",
    "https://linkedin.com/in/s0md3v",
    "https://instagram.com/s0md3v",
    "https://linuxsecurity.expert/p/somdev-sangwan"
  ],
  "subjectOf": [
    {
      "@type": "CreativeWork",
      "name": "BleepingComputer: Hacker says hijacking libraries, stealing AWS keys was ethical research",
      "url": "https://www.bleepingcomputer.com/news/security/hacker-says-hijacking-libraries-stealing-aws-keys-was-ethical-research/"
    },
    {
      "@type": "CreativeWork",
      "name": "The Hacker News: PyPi Package 'ctx' and PHP Library 'phpass' Compromised",
      "url": "https://thehackernews.com/2022/05/pypi-package-ctx-and-php-library-phpass.html"
    },
    {
      "@type": "CreativeWork",
      "name": "India Today: Hacker Claims He Can Crack Aadhaar Password in 3 Seconds",
      "url": "https://www.indiatoday.in/technology/news/story/hacker-claims-he-can-crack-aadhaar-password-in-3-seconds-1306400-2018-08-06"
    },
    {
      "@type": "CreativeWork",
      "name": "Deccan Herald: I've seen all your data without hacking",
      "url": "https://www.deccanherald.com/opinion/i-ve-seen-all-your-data-without-hacking-812289.html"
    }
  ]
}
</script>
</head>

<body>
  <div class="homepage">
    <div class="corner-layer">
      <div class="corner-annotation top-left" style="transform: rotate(-2deg); max-width: 250px; line-height: 1.4;">
        "There is time for work and time for love. That leaves no other time."
      </div>
      <div class="corner-annotation top-right" style="text-align: right;">
        <div style="transform: rotate(3deg); color: var(--link-visited); margin-bottom: 0.5rem;">#1756a9</div>
        <div id="mode-switch" role="button" tabindex="0"
          style="cursor: pointer; text-decoration: underline; transform: rotate(-1deg); pointer-events: auto;">light
          mode
        </div>
      </div>

      <div class="corner-annotation bottom-left"
        style="transform: rotate(1deg); left: 3vw; bottom: 3vw; line-height: 1.6;">
        <div style="margin-bottom: 0.2rem;">todo:</div>
        <div class="todo-item done"><span class="checkbox" style="display:inline-block; width:1.2rem;">✓</span>learn
          ui/ux</div>
        <div class="todo-item done"><span class="checkbox" style="display:inline-block; width:1.2rem;">✓</span>build my
          product</div>
        <div class="todo-item pending" data-msg="i need to do this myself"><span class="checkbox"
            style="display:inline-block; width:1.2rem;">□</span>learn marketing</div>
        <div class="todo-item pending" data-msg="patience..."><span class="checkbox"
            style="display:inline-block; width:1.2rem;">□</span>launch my product</div>
      </div>

      <div class="corner-annotation bottom-right" style="transform: rotate(2deg); opacity: 0.6; text-align: center;">
        <svg width="60" height="50" viewBox="0 0 60 50"
          style="display: block; margin: 0 auto 5px auto; overflow: visible;">
          <path d="M 10 30 Q 5 10 20 10 Q 35 10 30 30" fill="none" stroke="currentColor" stroke-width="1.5"
            stroke-linecap="round" />
          <path d="M 10 15 L 5 5 L 15 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          <path d="M 30 15 L 35 5 L 25 12" fill="none" stroke="currentColor" stroke-width="1.5"
            stroke-linecap="round" />
          <path d="M 15 20 L 18 22 L 25 20" fill="none" stroke="currentColor" stroke-width="1.5"
            stroke-linecap="round" />
          <path d="M 20 30 Q 30 50 50 40" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          <path d="M 50 40 Q 55 30 50 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
        </svg>
        <span style="font-size: 0.9em;">curiosity built the cat</span>
      </div>
    </div>

    <div id="hand-tooltip"
      style="position: absolute; top: 15vh; left: 50%; transform: translateX(-50%) rotate(-1deg); opacity: 0; transition: opacity 0.3s ease; pointer-events: none; text-align: center; color: var(--link-visited); font-family: 'Biro Script US Plus', monospace; font-size: 1.8rem; z-index: 10; white-space: nowrap;">
      <svg style="position: absolute; top: -10px; left: 0; width: 100%; height: 100%; z-index: -1; overflow: visible;">
        <path class="tooltip-path" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.8" />
      </svg>
      <span id="tooltip-text" style="position: relative; z-index: 1; display: inline-block; padding: 0 10px;">tooltip
        text</span>
    </div>

    <div class="menu">
      <div class="menuline">
        <span class="menuheader">[meta]</span>
        <span class="menulinks">
          <a href="/about">about</a>,
          <a href="/work" class="sketch-anchor">
            work with me
            <div class="sketch-note note-right">
              <span class="sketch-text">selectively available</span>
            </div>
          </a>
        </span>
      </div>
      <div class="menuline">
        <span class="menuheader">[tech]</span>
        <span class="menulinks">
          <a href="/projects" class="sketch-anchor">
            projects
            <div class="sketch-note note-left">
              <span class="sketch-text">~100k stars <span style="font-size:0.8em">(github)</span></span>
            </div>
          </a>,
          <a href="/blog">blog</a>,
          <a href="/papers" class="sketch-anchor">
            papers
            <div class="sketch-note note-right-far">
              <span class="sketch-text">only 2 :(</span>
            </div>
          </a>
        </span>
      </div>
      <div class="menuline" style="position: relative;">
        <span class="menuheader">[misc]</span>
        <span class="menulinks">
          <a href="/gallery">gallery</a>,
          <a href="/philosophy">philosophy</a>
        </span>

        <div class="layout-guide"
          style="position: absolute; left: 50%; bottom: -4rem; transform: translateX(-50%); pointer-events: none; z-index: -1;">
          <svg width="60" height="60" viewBox="0 0 60 60" style="overflow: visible;">
            <line x1="30" y1="10" x2="30" y2="50" stroke="var(--link-visited)" stroke-width="1" opacity="0.4" />
            <line x1="25" y1="10" x2="35" y2="10" stroke="var(--link-visited)" stroke-width="1" opacity="0.4" />
            <line x1="25" y1="50" x2="35" y2="50" stroke="var(--link-visited)" stroke-width="1" opacity="0.4" />
            <text x="40" y="35" font-family="'Biro Script US Plus', monospace" font-size="16" fill="var(--link-visited)"
              opacity="0.6">5vh</text>
          </svg>
        </div>
      </div>
    </div>
    <div style="position: relative; width: fit-content; margin: 0 auto;">
      <h1
        style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0;">
        Somdev Sangwan (s0md3v) - Security Researcher</h1>
    </div>

    <div class="menuline" style="text-align: center; position: relative;">

      <div class="sketch-note note-bottom">
        <span class="sketch-text">I reply.</span>
      </div>

      <a href="https://github.com/s0md3v" target="_blank" aria-label="GitHub Profile" class="social-link">
        <svg width="4vw" height="4vw" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" color="#000000"
          style="width: 6vw; max-width: 70px; max-height: 42px; min-width: 24px;">
          <path
            d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
            stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          <path
            d="M14.3333 19V17.137C14.3583 16.8275 14.3154 16.5163 14.2073 16.2242C14.0993 15.9321 13.9286 15.6657 13.7067 15.4428C15.8 15.2156 18 14.4431 18 10.8989C17.9998 9.99256 17.6418 9.12101 17 8.46461C17.3039 7.67171 17.2824 6.79528 16.94 6.01739C16.94 6.01739 16.1533 5.7902 14.3333 6.97811C12.8053 6.57488 11.1947 6.57488 9.66666 6.97811C7.84666 5.7902 7.05999 6.01739 7.05999 6.01739C6.71757 6.79528 6.69609 7.67171 6.99999 8.46461C6.35341 9.12588 5.99501 10.0053 5.99999 10.9183C5.99999 14.4366 8.19999 15.2091 10.2933 15.4622C10.074 15.6829 9.90483 15.9461 9.79686 16.2347C9.68889 16.5232 9.64453 16.8306 9.66666 17.137V19"
            stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M9.66667 17.7018C7.66667 18.3335 6 17.7018 5 15.7544" stroke="#000000" stroke-width="1.5"
            stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </a>
      <a href="https://twitter.com/s0md3v" target="_blank" aria-label="X (Twitter) Profile" class="social-link">
        <svg width="4vw" height="4vw" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" color="#000000"
          style="width: 6vw; max-width: 70px; max-height: 42px; min-width: 24px;">
          <path
            d="M23 3.01006C23 3.01006 20.9821 4.20217 19.86 4.54006C19.2577 3.84757 18.4573 3.35675 17.567 3.13398C16.6767 2.91122 15.7395 2.96725 14.8821 3.29451C14.0247 3.62177 13.2884 4.20446 12.773 4.96377C12.2575 5.72309 11.9877 6.62239 12 7.54006V8.54006C10.2426 8.58562 8.50127 8.19587 6.93101 7.4055C5.36074 6.61513 4.01032 5.44869 3 4.01006C3 4.01006 -1 13.0101 8 17.0101C5.94053 18.408 3.48716 19.109 1 19.0101C10 24.0101 21 19.0101 21 7.51006C20.9991 7.23151 20.9723 6.95365 20.92 6.68006C21.9406 5.67355 23 3.01006 23 3.01006Z"
            stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </a>
      <a href="https://www.instagram.com/s0md3v" target="_blank" aria-label="Instagram Profile" class="social-link">
        <svg width="4vw" height="4vw" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" color="#000000"
          style="width: 6vw; max-width: 70px; max-height: 42px; min-width: 24px;">
          <path
            d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z"
            stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          <path
            d="M3 16V8C3 5.23858 5.23858 3 8 3H16C18.7614 3 21 5.23858 21 8V16C21 18.7614 18.7614 21 16 21H8C5.23858 21 3 18.7614 3 16Z"
            stroke="#000000" stroke-width="1.5"></path>
          <path d="M17.5 6.51L17.51 6.49889" stroke="#000000" stroke-width="1.5" stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
      </a>
      <a href="mailto:s0md3v@gmail.com" aria-label="Email Me" class="social-link">
        <svg width="4vw" height="4vw" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" color="#000000"
          style="width: 6vw; max-width: 70px; max-height: 42px; min-width: 24px;">
          <path d="M7 9L12 12.5L17 9" stroke="#000000" stroke-width="1.5" stroke-linecap="round"
            stroke-linejoin="round"></path>
          <path
            d="M2 17V7C2 5.89543 2.89543 5 4 5H20C21.1046 5 22 5.89543 22 7V17C22 18.1046 21.1046 19 20 19H4C2.89543 19 2 18.1046 2 17Z"
            stroke="#000000" stroke-width="1.5"></path>
        </svg>
      </a>
      <a href="https://www.linkedin.com/in/s0md3v" target="_blank" aria-label="LinkedIn Profile" class="social-link">
        <svg width="4vw" height="4vw" stroke-width="1.5" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" color="#000000"
          style="width: 6vw; max-width: 70px; max-height: 42px; min-width: 24px;">
          <path
            d="M21 8V16C21 18.7614 18.7614 21 16 21H8C5.23858 21 3 18.7614 3 16V8C3 5.23858 5.23858 3 8 3H16C18.7614 3 21 5.23858 21 8Z"
            stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M7 17V13.5V10" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          </path>
          <path d="M11 17V13.75M11 10V13.75M11 13.75C11 10 17 10 17 13.75V17" stroke="#000000" stroke-width="1.5"
            stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M7 7.01L7.01 6.99889" stroke="#000000" stroke-width="1.5" stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
      </a>
      <div class="mobile-footer">it looks better on computer!</div>
    </div>
    <style>
      .mobile-footer {
        display: none;
      }


      .homepage {
        margin: auto 0;
      }

      .menu {
        font-size: clamp(1.1rem, 2.5vw, 2.5vw);
        margin: 5vh auto;
        width: fit-content;
        white-space: nowrap;
      }

      .menuline {
        margin: 2ch 0;
        padding: 0 2rem;
        color: var(--muted-color);
      }

      .menuline a {
        text-decoration: none;
        color: var(--foreground-color);
      }

      .menuline a:hover {
        color: var(--accent-color);
        text-decoration: none;
        text-decoration-color: var(--foreground-color);
        background: transparent;
      }

      .social-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 44px;
        min-height: 44px;
        padding: 5px;
        margin: 5px;
        border-radius: 8px;
        transition: background-color 0.2s;
      }

      .social-link:hover {
        background-color: var(--link-hover-bg);
      }

      .menuheader {
        font-family: "Biro Script US Plus", monospace;
        color: var(--link-visited);
        font-size: 2.4rem;
        padding-right: 5%;
        display: inline-block;
        width: 5.5rem;
        text-align: right;
        position: relative;
        top: -0.1rem;
        opacity: 0.8;
      }

      .layout-guides {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .menulinks {
        font-family: "Comfortaa", sans-serif;
      }

      @media (max-width: 575.98px) {
        .menuline {
          padding: 0 5vw;
          font-size: 1.4rem;
        }

        .menuheader {
          font-size: 0.9rem;
        }

        .menulinks:before {
          display: none;
        }

        /* Hide all sketches/annotations/graphics on mobile */
        .corner-layer,
        .sketch-note,
        .layout-guide,
        #hand-tooltip {
          display: none !important;
        }



        .mobile-footer {
          display: block;
          margin-top: 3rem;
          text-align: center;
          font-size: 1.2rem;
          color: var(--link-visited);
          font-family: "Biro Script US Plus", monospace;
          opacity: 0.8;
        }
      }

      .dark-mode .homepage svg {
        filter: invert(1);
      }

      .dark-mode .homepage .corner-annotation svg,
      .dark-mode .homepage #hand-tooltip svg,
      .dark-mode .homepage .layout-guide svg,
      .dark-mode .menuline svg {
        filter: none !important;
      }

      /* Sketch Layer styles moved to common.css */

      /* Todo List Interaction */
      .todo-item {
        pointer-events: auto;
        /* Enable interaction since parent is pointer-events: none */
      }

      .todo-item.pending {
        cursor: pointer;
        position: relative;
        transition: color 0.2s ease;
      }

      .todo-shake {
        animation: shake 0.4s cubic-bezier(.36, .07, .19, .97) both;
        color: #ea4335 !important;
        /* Error red */
      }

      @keyframes shake {

        10%,
        90% {
          transform: translate3d(-1px, 0, 0);
        }

        20%,
        80% {
          transform: translate3d(2px, 0, 0);
        }

        30%,
        50%,
        70% {
          transform: translate3d(-4px, 0, 0);
        }

        40%,
        60% {
          transform: translate3d(4px, 0, 0);
        }
      }

      .todo-msg {
        position: absolute;
        left: 100%;
        top: 50%;
        transform: translateY(-50%);
        background: var(--background-color);
        border: 1px solid var(--accent-color);
        color: var(--accent-color);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.8rem;
        white-space: nowrap;
        margin-left: 10px;
        opacity: 0;
        pointer-events: none;
        font-family: var(--base-font-family);
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        z-index: 10;
        font-weight: normal;
      }

      .todo-msg.show {
        animation: fadeInOut 2s forwards;
      }

      @keyframes fadeInOut {
        0% {
          opacity: 0;
          transform: translateY(-50%) scale(0.9);
        }

        10% {
          opacity: 1;
          transform: translateY(-50%) scale(1);
        }

        80% {
          opacity: 1;
          opacity: 1;
        }

        /* Stay visible for a bit */
        100% {
          opacity: 0;
          transform: translateY(-50%) scale(1);
        }
      }
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const modeSwitch = document.getElementById('mode-switch');
        if (modeSwitch) {
          const themeNames = {
            'light': 'light mode',
            'dark': 'dark mode',
            'cream': 'cream mode'
          };

          function updateModeText() {
            const current = getPreferredTheme();
            modeSwitch.textContent = themeNames[current] || 'light mode';
          }

          updateModeText();

          modeSwitch.addEventListener('click', () => {
            const current = getPreferredTheme();
            let nextIndex = (themes.indexOf(current) + 1) % themes.length;
            const nextTheme = themes[nextIndex];
            applyTheme(nextTheme);
            updateModeText();
          });

          // Keyboard accessibility for mode switch
          modeSwitch.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              modeSwitch.click();
            }
          });
        }

        const handwrittenSelectors = [
          '.corner-annotation',
          '.sketch-text',
          '.todo-item'
        ];

        handwrittenSelectors.forEach(selector => {
          document.querySelectorAll(selector).forEach(el => {
            const variation = 0.92 + Math.random() * 0.16;
            const currentSize = parseFloat(getComputedStyle(el).fontSize);
            el.style.fontSize = (currentSize * variation) + 'px';
          });
        });

        const tooltip = document.getElementById('hand-tooltip');
        const tooltipText = document.getElementById('tooltip-text');
        const tooltipSvgPath = tooltip ? tooltip.querySelector('path') : null;

        if (tooltip && tooltipText && tooltipSvgPath) {
          const linkMap = {
            '/about': 'Somdev Sangwan aka s0md3v',
            '/work': 'need help with your security product?',
            '/projects': 'i picked the best 10',
            '/blog': 'research, hacking, dev',
            '/papers': 'high effort research',
            '/gallery': 'good photos, i promise',
            '/philosophy': 'i write essays',
            'https://github.com/s0md3v': 'sponsor me ^_^',
            'https://twitter.com/s0md3v': 'quality posting only',
            'https://instagram.com/s0md3v': 'strictly non-professional',
            'mailto:s0md3v@gmail.com': 'need a pgp key?',
            'https://www.linkedin.com/in/s0md3v': '"lets connect" :D'
          };

          function updateTooltipShape(text) {
            tooltipText.textContent = text;

            requestAnimationFrame(() => {
              const textWidth = tooltipText.offsetWidth;
              const textHeight = tooltipText.offsetHeight;

              const paddingX = 40;
              const paddingY = 25;

              const width = textWidth + paddingX * 2;
              const height = textHeight + paddingY * 2;

              let seed = 0;
              for (let i = 0; i < text.length; i++) seed += text.charCodeAt(i);
              const random = () => {
                const x = Math.sin(seed++) * 10000;
                return x - Math.floor(x);
              };

              const r = (mag = 5) => (random() - 0.5) * mag * 2;

              const completeness = 0.85 + (random() * 0.2);

              const startX = 5 + r(2);
              const midY = height / 2 + r(3);
              const startY = midY + r(2);

              const midX = width / 2 + r(5);
              const endX = width - 5 + r(2);

              const topY = 5 + r(3);
              const bottomY = height - 5 + r(2);

              const cpTopX = midX + r(10);
              const cpTopY = topY - r(5);

              const cpBottomX = midX + r(10);
              const cpBottomY = bottomY + r(5);

              let d = `M ${startX} ${startY}`;

              d += ` Q ${startX - r(5)} ${topY} ${cpTopX} ${topY}`;
              d += ` Q ${endX + r(5)} ${topY} ${endX} ${midY + r(2)}`;

              if (completeness > 0.5) {
                d += ` Q ${endX + r(5)} ${bottomY} ${cpBottomX} ${bottomY}`;
              }

              if (completeness > 0.9) {
                const overlapX = startX + r(15);
                const overlapY = startY + r(10) - 5;
                d += ` Q ${startX - r(5)} ${bottomY} ${overlapX} ${overlapY}`;
              } else {
                const gapX = startX + 20 + r(10);
                const gapY = bottomY - r(5);
                d += ` Q ${startX + 50} ${bottomY} ${gapX} ${gapY}`;
              }

              tooltipSvgPath.setAttribute('d', d);

              const svg = tooltip.querySelector('svg');
              svg.setAttribute('width', width);
              svg.setAttribute('height', height);
              svg.setAttribute('viewBox', `0 0 ${width} ${height}`);

              svg.style.width = width + 'px';
              svg.style.height = height + 'px';
              svg.style.top = (-paddingY) + 'px';
              svg.style.left = (-paddingX) + 'px';
            });
          }

          document.querySelectorAll('.menulinks a, .homepage a').forEach(link => {
            const path = link.getAttribute('href');

            const showTooltip = () => {
              if (linkMap[path]) {
                updateTooltipShape(linkMap[path]);
                tooltip.style.opacity = '1';
              }
            };

            const hideTooltip = () => {
              tooltip.style.opacity = '0';
            };

            link.addEventListener('mouseenter', showTooltip);
            link.addEventListener('focus', showTooltip);

            link.addEventListener('mouseleave', hideTooltip);
            link.addEventListener('blur', hideTooltip);
          });
        }

        const todoItems = document.querySelectorAll('.todo-item.pending');
        todoItems.forEach(item => {
          let clicks = 0;
          const checkbox = item.querySelector('.checkbox');
          const originalText = checkbox.textContent;
          let isAnimating = false;

          const messages = [
            item.dataset.msg || "not yet...",
            "i said not yet!",
            "seriously?",
            "...",
            "stop it."
          ];

          item.addEventListener('click', function () {
            if (isAnimating) return;
            isAnimating = true;

            if (clicks >= messages.length) {
              const container = this.closest('.corner-annotation');
              if (container) {
                container.innerHTML = ":p";
                container.style.fontSize = "3rem";
                container.style.textAlign = "center";
                container.style.display = "flex";
                container.style.justifyContent = "center";
                container.style.alignItems = "center";
              }
              return;
            }

            const checkbox = this.querySelector('.checkbox');

            checkbox.textContent = '✓';
            this.classList.add('done');

            setTimeout(() => {
              checkbox.textContent = originalText;
              this.classList.remove('done');
              this.classList.add('todo-shake');

              let msgText = messages[clicks];
              clicks++;

              let msgEl = this.querySelector('.todo-msg');
              if (!msgEl) {
                msgEl = document.createElement('div');
                msgEl.className = 'todo-msg';
                this.appendChild(msgEl);
              }

              msgEl.textContent = msgText;
              msgEl.classList.remove('show');
              void msgEl.offsetWidth;
              msgEl.classList.add('show');

              setTimeout(() => {
                this.classList.remove('todo-shake');
                isAnimating = false;
              }, 400);
            }, 200);
          });
        });
      });
    </script>
</body>

</html>